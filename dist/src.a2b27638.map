{"version":3,"sources":["src/React/index.js","src/ReactDOM/index.js","src/index.js"],"names":["TEXT_ELEMENT","createElement","type","config","props","Object","assign","args","hasChildren","length","rawChildren","concat","children","filter","c","map","createTextElement","value","nodeValue","React","rootInstance","render","element","container","prevInstance","nextInstance","reconcile","parentDom","instance","newInstance","instantiate","appendChild","dom","updateDomProperties","isTextElement","document","createTextNode","childElements","childInstances","childDoms","childInstance","forEach","childDom","prevProps","nextProps","isEvent","name","startsWith","isAttribute","keys","eventType","toLowerCase","substring","removeEventListener","addEventListener","ReactDOM","tick","time","Date","toLocaleTimeString","clockElement","getElementById","setInterval"],"mappings":"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","file":"src.a2b27638.map","sourceRoot":"..","sourcesContent":["// import Component from './component'\n\nconst TEXT_ELEMENT = 'TEXT ELEMENT'\n\nfunction createElement (type, config, ...args) {\n    const props = Object.assign({}, config)\n    const hasChildren = args.length > 0\n    const rawChildren = hasChildren ? [].concat(...args) : []\n\n    // 过滤空值，将文本类型的转成规范数据格式\n    props.children = rawChildren\n        .filter(c => c != null && c !== false)\n        .map(c => c instanceof Object ? c : createTextElement(c))\n\n    return { type, props }\n}\n\nfunction createTextElement (value) {\n    // 规范数据格式\n    return createElement(TEXT_ELEMENT, { nodeValue: value })\n}\n\nconst React = {\n    createElement,\n    // Component\n}\n\nexport default React\n","let rootInstance = null\n\nfunction render (element, container) {\n    const prevInstance = rootInstance\n    const nextInstance = reconcile(container, prevInstance, element)\n\n    rootInstance = nextInstance\n}\n\n/**\n * \n * @param {*} parentDom \n * @param {*} instance \n * @param {*} element \n */\nfunction reconcile (parentDom, instance, element) {\n    if (instance === null) {\n        const newInstance = instantiate(element)\n        parentDom.appendChild(newInstance.dom)\n\n        return newInstance\n    } else if (instance.element.type === element.type) {\n        updateDomProperties(instance.dom, instance.element.props, element.props)\n        instance.element = element\n\n        return instance\n    } else {\n        const newInstance = instantiate(element)\n        parentDom.appendChild(newInstance.dom, instance.dom)\n\n        return newInstance\n    }\n}\n\n/**\n * \n * @param {*} element \n */\nfunction instantiate (element) {\n    const { type, props } = element\n\n    /** 1 */\n    // 创建dom节点\n    const isTextElement = type === 'TEXT ELEMENT'\n    const dom = isTextElement\n        ? document.createTextNode('')\n        : document.createElement(type)\n\n    updateDomProperties(dom, [], props) // <--------------\n\n    /** 2 */\n    // 将他的children节点们递归 创建实例\n    const childElements = props.children || []\n    const childInstances = childElements.map(instantiate)\n    /** 3 */\n    const childDoms = childInstances.map(childInstance => childInstance.dom)\n    \n    /** 4 */\n    childDoms.forEach(childDom => dom.appendChild(childDom))\n\n    const instance = {\n        dom,\n        element,\n        childInstances\n    }\n\n    return instance\n}\n\n/**\n * 从dom节点中，删除所有旧属性，添加新属性\n * @param {*} dom \n * @param {*} prevProps \n * @param {*} nextProps \n */\nfunction updateDomProperties (dom, prevProps, nextProps) {\n    const isEvent = name => name.startsWith('on')\n    const isAttribute = name => !isEvent(name) && name !== 'children'\n    \n    // 解绑prev事件\n    Object.keys(prevProps).filter(isEvent).forEach(name => {\n        const eventType = name.toLowerCase().substring(2)\n        dom.removeEventListener(eventType, prevProps[name])\n    })\n\n    // 移除prev属性\n    Object.keys(prevProps).filter(isAttribute).forEach(name => {\n        dom[name] = null\n    })\n\n    // 绑定next事件\n    Object.keys(nextProps).filter(isEvent).forEach(name => {\n        const eventType = name.toLowerCase().substring(2)\n        dom.addEventListener(eventType, nextProps[name])\n    })\n\n    // 设置next属性\n    Object.keys(nextProps).filter(isAttribute).forEach(name => {\n        dom[name] = nextProps[name]\n    })\n}\n\nconst ReactDOM = {\n    render,\n}\n\nexport default ReactDOM\n","import React from './React'\nimport ReactDOM from './ReactDOM'\n\n// class Welcome extends React.Component {\n//     constructor(props) {\n//         super(props);\n//         this.state = {\n//             count: 0\n//         }\n\n//         this.handleAddCount = this.handleAddCount.bind(this)\n//     }\n//     componentWillMount () {\n//         console.log('WillMount')\n//     }\n//     componentWillReceiveProps () {\n//         console.log('WillReceiveProps')\n//     }\n//     componentWillUpdate () {\n//         console.log('WillUpdate')\n//     }\n//     componentDidUpdate () {\n//         console.log('DidUpdate')\n//     }\n//     componentDidMount () {\n//         console.log('DidMount')\n//     }\n    \n//     handleAddCount () {\n//         this.setState({\n//             count: this.state.count + 1\n//         })\n//     }\n\n//     render () {\n//         return (\n//             <div>\n//                 <h1>Hello, { this.props.name }</h1>\n//                 <h3>当前数值 <span style={{color: 'red'}}>{ this.state.count }</span></h3>\n//                 <button onClick={this.handleAddCount}>Add</button>\n//             </div>\n//         )\n//     }\n// }\n\n// const element = <Welcome name=\"World\" />\n\n// ReactDOM.render(\n//     element,\n//     document.getElementById('root')\n// )\n\nfunction tick () {\n    const time = new Date().toLocaleTimeString()\n    const clockElement = <h1>{time}</h1>\n\n    ReactDOM.render(clockElement, document.getElementById('root'))\n}\n\ntick()\n\nsetInterval(tick, 1000)\n"]}